---
author: "Kirill MÃ¼ller"
date: "2024-04-02"
title: "The future of DBI, 2/*"
description: "Summarizing the progress of 2022 and 2023"
draft: true
---

This is a continuation of the [first blog post](https://r-dbi.org/blog/posts/dbi-4-1/) in this series.

## Measuring responsiveness

For 2022 and 2023, no concrete new features were planned.
Instead, the focus has been on establishing a steady pace of maintenance and responsiveness to user feedback.
This blog post shows how we have been doing in this regard.

```{r include = FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  collapse = TRUE,
  comment = "#>"
)

library(here)
library(ggplot2)
library(dplyr)

issues_tbl <- qs::qread(here("03-issues_tbl.qs"))
issues_comments_tbl <- qs::qread(here("03-issues_comments_tbl.qs"))

my_issues_tbl <-
  issues_tbl |>
  transmute(
    repo,
    issue_url,
    number,
    state,
    issue_created_at,
    issue_closed_at,
    issue_author_association,
    issue_author_is_member = (issue_author_association == "MEMBER"),
    issue_is_pr = !is.na(pull_request$url),
    issue_html_url,
  )

my_issues_comments_tbl <-
  issues_comments_tbl |>
  transmute(id, issue_url, user_login = user$login, author_is_member = (author_association == "MEMBER"), created_at)

issues_vs_first_member_comment <-
  my_issues_comments_tbl |>
  filter(author_is_member) |>
  filter(row_number() == 1, .by = issue_url) |>
  full_join(my_issues_tbl, join_by(issue_url))
```

This analysis is based on the GitHub issues opened in the r-dbi organization since development has moved to GitHub, for the following packages: DBI, DBItest, RMariaDB, RPostgres, RSQLite, dblog, RKazam.

### GitHub issues

In total, `r nrow(issues_tbl)` issues were opened in the package repositories.
The following bar chart shows the number of issues opened per year.

```{r}
my_issues_tbl |> 
  filter(!issue_is_pr) |> 
  mutate(year = lubridate::year(issue_created_at)) |> 
  mutate(issue_author_association = factor(issue_author_association, levels = c("MEMBER", "CONTRIBUTOR", "NONE"))) |>
  ggplot(aes(factor(year), fill = issue_author_association)) +
  geom_bar() +
  labs(
    x = "Year", 
    y = "Number of issues", 
    fill = "Author association",
    title = "Issues opened per year"
  ) +
  theme(axis.text.x = element_text(angle = 90, hjust = 0, vjust = 0.5))
```

In recent years, the vast majority of the issues were opened by contributors and non-members.

FIXME: How many issues led to PRs that have been merged?

To analyze responsiveness, we consider the time it takes from opening an issue by a non-member to the first response by a member, and to closing the issue.

```{r}
issues_vs_first_member_comment |> 
  filter(!issue_is_pr) |> 
  filter(!issue_author_is_member) |>
  mutate(
    new = lubridate::year(issue_created_at) >= 2022,
    time = as.numeric(created_at - issue_created_at) / 86400,
    time_bin = santoku::chop(time, c(0, 1, 4, 14, 180))
  ) |>
  count(new, time_bin) |>
  mutate(.by = new, prop = n / sum(n)) |> 
  mutate(new_label = ifelse(new, "2022 and later", "before 2022"))
```
